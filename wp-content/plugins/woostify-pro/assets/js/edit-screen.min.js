"use strict";var woostifySearchDelay=function(){var timer=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(callback,ms){clearTimeout(timer),timer=setTimeout(callback,ms)}}(),woostifyMultiSelect=function(){var meta=document.querySelectorAll(".woostify-multi-selection");meta.length&&meta.forEach((function(element){var input=element.querySelector(".woostify-multi-select-value"),selection=element.querySelector(".woostify-multi-select-selection"),inner=selection.querySelector(".woostify-multi-selection-inner"),search=selection.querySelector(".woostify-multi-select-search"),dropdown=element.querySelector(".woostify-multi-select-dropdown"),saveItem=function(echo){var selectionItem=inner.querySelectorAll(".woostify-multi-select-id");if(selectionItem.length){var data=[];if(selectionItem.forEach((function(ele){var saveId=ele.getAttribute("data-id");saveId&&!data.includes(saveId)&&data.push(saveId)})),!0===echo)return data;input.value=data.join("|")}else input.value="default"},removeItem=function(){var selectionItem=inner.querySelectorAll(".woostify-multi-select-id");selectionItem.length&&selectionItem.forEach((function(el){var selectedId=el.getAttribute("data-id"),removeButton=el.querySelector(".woostify-multi-remove-id");removeButton&&(removeButton.onclick=function(){if(el.parentNode){element.classList.add("active");var isThis=dropdown.querySelector('[data-id="'+selectedId+'"]');isThis&&isThis.classList.remove("disabled"),el.remove(),saveItem()}})}))};removeItem();var addItem=function(){var dropdownItem=dropdown.querySelectorAll(".woostify-multi-select-id");if(dropdownItem.length)for(var i=0,j=dropdownItem.length;i<j;i++)dropdownItem[i].onclick=function(){var t=this,disabled=t.classList.contains("disabled"),dataId=t.getAttribute("data-id");if(!disabled){t.classList.add("disabled");var currentId='<span class="woostify-multi-select-id" data-id="'+dataId+'">'+t.innerHTML+'<i class="woostify-multi-remove-id dashicons dashicons-no-alt"></i></span>';inner.insertAdjacentHTML("afterbegin",currentId),saveItem(),removeItem()}}};search&&(search.addEventListener("input",(function(){var that=this,nonce=this.getAttribute("data-nonce"),searchValue=this.value.trim(),searchName=this.name,immediate=this.getAttribute("data-search"),request=new Request(ajaxurl,{method:"POST",body:"action="+searchName+"&security_nonce="+nonce+"&keyword="+searchValue,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});if("immediate"===immediate)addItem();else{if(searchValue.length<1)return void(dropdown.innerHTML="");woostifySearchDelay((function(){fetch(request).then((function(res){200===res.status?res.json().then((function(r){if(r.success){var parser,doc=(new DOMParser).parseFromString(r.data,"text/html"),ajaxDropdown=doc.querySelectorAll(".woostify-multi-select-id");ajaxDropdown.length&&ajaxDropdown.forEach((function(ajaxItem){var ajaxItemId=ajaxItem.getAttribute("data-id")||"",saveValue=saveItem(!0)||[];saveValue.length&&(saveValue.includes(ajaxItemId)?ajaxItem.classList.add("disabled"):ajaxItem.classList.remove("disabled"))})),dropdown.innerHTML=doc.body.innerHTML,addItem()}})):console.log("Status Code: "+res.status)})).catch((function(err){dropdown.innerHTML="",console.log(err)}))}),500)}})),search.addEventListener("focus",(function(e){element.classList.add("active"),removeItem(),"immediate"===this.getAttribute("data-search")&&addItem()}))),document.addEventListener("click",(function(e){var current=e.target,isParent=current.closest(".woostify-multi-selection"),isRemove=current.classList.contains("woostify-multi-remove-id"),isSelect=current.classList.contains("woostify-multi-select-id"),isSearch=current.classList.contains("woostify-multi-select-search");isParent==element&&(selection===current||isRemove||isSelect||isSearch)||element.classList.remove("active")}))}))},prevSiblings=function(target){for(var siblings=[],n=target;n=n.previousElementSibling;)siblings.push(n);return siblings},nextSiblings=function(target){for(var siblings=[],n=target;n=n.nextElementSibling;)siblings.push(n);return siblings},siblings=function(target){var prev=prevSiblings(target)||[],next=nextSiblings(target)||[];return prev.concat(next)},woostifyMultiDependency=function(){var dep=document.querySelectorAll(".woostify-multi-dependency");dep.length&&dep.forEach((function(element){var item=element.querySelectorAll(".woostify-multi-dependency-item [name]");item.length&&item.forEach((function(ele,index){var parent=ele.closest(".woostify-multi-dependency-item"),parentStart;parent.getAttribute("data-dependency")&&ele.addEventListener("change",(function(){var currentValue=ele.value,currentChild=parseInt(index)+1,allDependency=element.querySelectorAll(".woostify-multi-dependency-item:nth-child("+currentChild+') ~ .woostify-multi-dependency-item[data-required="'+currentValue+'"]'),allNext=siblings(parent);allNext.length&&allNext.forEach((function(en){var nextRequired;en.getAttribute("data-required")&&en.classList.remove("active")})),allDependency.length&&allDependency.forEach((function(el){var required=el.getAttribute("data-required"),updated=el.getAttribute("data-value"),onChange=new Event("change"),_name;el.querySelector("[name]").dispatchEvent(onChange),"checkbox"==ele.type?ele.checked?el.classList.add("active"):el.classList.remove("active"):currentValue==required?el.classList.add("active"):el.classList.remove("active")}))}))}))}))},woostifyUpdateValue=function(){var box=document.querySelector(".woostify-featured-setting");if(box){var field=box.querySelectorAll('[type="checkbox"]');field.length&&field.forEach((function(el){el.onchange=function(){el.value=1==el.value?0:1}}))}},woostifyDependency=function(){var filter=document.querySelectorAll(".woostify-filter-value");filter.length&&filter.forEach((function(fil){fil.addEventListener("change",(function(){var parent=fil.closest(".woostify-filter-item"),siblings=nextSiblings(parent);siblings.length&&fil.value.trim()&&siblings.forEach((function(sib){var type=sib.getAttribute("data-type");type&&("checkbox"===fil.type?fil.checked&&type==fil.value?sib.classList.remove("hidden"):sib.classList.add("hidden"):type.includes(fil.value)?sib.classList.remove("hidden"):sib.classList.add("hidden"))}))}))}))},woostifyTabSettings=function(){var section=document.querySelector(".woostify-settings-section-tab");if(section){var button=section.querySelectorAll(".tab-head-button");button.length&&(button.forEach((function(element){element.onclick=function(){var id=element.hash?element.hash.substr(1):"",idSiblings=siblings(element),tab=section.querySelector('.woostify-setting-tab-content[data-tab="'+id+'"]'),tabSiblings=siblings(tab);element.classList.add("active"),idSiblings.length&&idSiblings.forEach((function(el){el.classList.remove("active")})),tab.classList.add("active"),tabSiblings.length&&tabSiblings.forEach((function(el){el.classList.remove("active")}))}})),window.addEventListener("load",(function(){var currentTab=section.querySelector('a[href="'+window.location.hash+'"]'),generalTab=section.querySelector('a[href="#general"]');currentTab?currentTab.click():generalTab&&generalTab.click()})))}},woostifySaveOptions=function(){var box=document.querySelector(".woostify-featured-setting");if(box){var _id=box.getAttribute("data-id")||"",_nonce=box.getAttribute("data-nonce")||"",save_option_messages=box.querySelector(".woostify-save-message"),buttons=box.querySelectorAll(".save-options");buttons.length&&_id&&_nonce&&buttons.forEach((function(button){button.onclick=function(){if(!button.getAttribute("disabled")&&!box.classList.contains("loading")){var t=this,likeId=_id.replace(/-/g,"_"),options=box.querySelectorAll("[name*=woostify_"+likeId+"]"),value={},required=box.querySelectorAll('[required="required"]'),isEmpty=!1;if(box.classList.contains("woostify-ajax-search-product-setting")){var mustChooseOption=box.querySelector(".must-choose-one-option"),checkboxInput=!!mustChooseOption&&mustChooseOption.querySelector('[type="checkbox"]'),checkedOption;if(!(mustChooseOption?mustChooseOption.querySelectorAll('[type="checkbox"]:checked'):[]).length&&checkboxInput)return void checkboxInput.focus()}if(required.length&&required.forEach((function(field){var fieldValue=field.value.trim(),fieldParent=field.closest(".woostify-setting-tab-content"),isHidden=field.closest(".woostify-filter-item.hidden"),fieldInTab=fieldParent?fieldParent.getAttribute("data-tab"):"";if(!isHidden&&!fieldValue){var emptyTab=box.querySelector('a[href="#'+fieldInTab+'"]');return emptyTab&&!emptyTab.classList.contains("active")&&emptyTab.click(),isEmpty=!0,void field.focus()}})),!isEmpty){box.classList.add("loading"),t.setAttribute("disabled","disabled"),t.innerHTML=woostify_edit_screen.saving+"...",options.length&&options.forEach((function(el,index){(el.value.trim()||el.classList.contains("woostify-admin-color-picker")||el.classList.contains("field-empty")||null!=el.closest(".woostify-custom-field-control"))&&(el.name.includes("[]")?value[el.name+"["+index+"]"]=el.value:value[el.name]=el.value)}));var request=new Request(ajaxurl,{method:"POST",body:encodeURI("action=woostify_save_"+likeId+"_options&security_nonce="+_nonce+"&setting_id="+_id+"&options="+JSON.stringify(value)),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(request).then((function(res){if(200===res.status){if(save_option_messages)save_option_messages.classList.add("success"),save_option_messages.querySelector(".message-success").innerHTML=woostify_edit_screen.saved_success,setTimeout((function(){save_option_messages.classList.remove("success")}),3e3);else{let infoSuccess;box.querySelector(".woostify-settings-section-footer .info-seuccess")||button.insertAdjacentHTML("afterend",'<span class="info-seuccess">'+woostify_edit_screen.saved_success+"</span>")}box.classList.remove("loading")}else console.log("Status Code: "+res.status)})).catch((function(){box.classList.remove("loading")})).finally((function(){t.innerHTML=woostify_edit_screen.saved,setTimeout((function(){t.innerHTML=woostify_edit_screen.save,t.removeAttribute("disabled")}),1e3)}))}}}}))}},woostifySaveOptionMessageClose=function(){var message_close_button=document.querySelector(".woostify-save-message-close");message_close_button&&message_close_button.addEventListener("click",(function(e){var parent;this.closest(".woostify-save-message").classList.remove("success")}))},woostifySaleNotificationRemoveMessage=function(){var messages=document.querySelector(".woostify-sale-notification-box-message");if(messages){var removeMessageButton=messages.querySelectorAll(".woostify-sale-notification-remove-message");removeMessageButton.length&&(removeMessageButton.forEach((function(element){element.onclick=function(){var t=this,disabled;if("disabled"!==(t.getAttribute("disabled")||"")&&(t.parentNode.remove(),messages.querySelectorAll(".woostify-sale-notification-remove-message").length<=1)){var lastEvent=new Event("lastMessage");document.documentElement.dispatchEvent(lastEvent)}}})),document.documentElement.addEventListener("lastMessage",(function(){var lastMessage=messages.querySelector(".woostify-sale-notification-remove-message");lastMessage&&lastMessage.setAttribute("disabled","disabled")})))}},woostifySaleNotificationAddNewMessage=function(){var box=document.querySelector(".woostify-featured-setting"),messages=!!box&&document.querySelector(".woostify-sale-notification-box-message"),firstMessage=messages?messages.querySelector(".woostify-sale-notification-message-inner"):"",removeLabel=firstMessage?firstMessage.querySelector(".woostify-sale-notification-remove-message").innerHTML:"",markupMessage='<div class="woostify-sale-notification-message-inner">';if(markupMessage+='<textarea name="woostify_sale_notification_message[]" required="required"></textarea>',markupMessage+='<span class="woostify-sale-notification-remove-message button">'+removeLabel+"</span>",markupMessage+="</div>",box&&messages&&firstMessage){var addNewButton=box.querySelector(".woostify-sale-notification-add-message");addNewButton&&(addNewButton.onclick=function(){messages.insertAdjacentHTML("beforeend",markupMessage),woostifySaleNotificationRemoveMessage();var lastMessage=messages.querySelector(".woostify-sale-notification-message-inner:last-of-type"),lastField=!!lastMessage&&lastMessage.querySelector("textarea");lastField&&lastField.focus();var removeDisabledAttr=messages.querySelector('.woostify-sale-notification-remove-message[disabled="disabled"]');removeDisabledAttr&&removeDisabledAttr.removeAttribute("disabled")})}},woostifyHeaderFooterBuilderSelectTemplate=function(){var templateEl=document.getElementById("woostify-header-footer-builder-template");templateEl&&templateEl.addEventListener("change",(function(){var btn=this,template=btn.value;if("default"===template)btn.closest(".input-wrapper").nextElementSibling.remove();else{var inputWrapper=btn.closest(".input-wrapper"),check=nextSiblings(inputWrapper),nonce=document.getElementById("woostify-hfb-nonce").value;if(0===check.length){var request=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_select_template&_ajax_nonce="+nonce+"&template="+template,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(request).then((function(res){200===res.status?res.json().then((function(r){if(r.success&&""!==r.data){var parser,data,ajaxInputWrapper=(new DOMParser).parseFromString(r.data,"text/html").querySelector(".input-wrapper");document.querySelector(".woostify-pro-hfb-options-wrapper").append(ajaxInputWrapper)}})):console.log("Status Code: "+res.status)}))}var sticky=document.querySelector(".condition-group.sticky");null!==sticky&&("header"===template?sticky.classList.contains("hidden")&&sticky.classList.remove("hidden"):sticky.classList.contains("hidden")||sticky.classList.add("hidden"))}}))},woostifyChangeDisplayOption=function(){if(document.getElementById("woostify-hfb-nonce")){var nonce=document.getElementById("woostify-hfb-nonce").value;document.addEventListener("change",(function(e){var curr=e.target,curr_id=curr.getAttribute("id");if("woostify-header-footer-builder-display-on"===curr_id||"woostify-header-footer-builder-no-display-on"===curr_id){var postType=curr.options[curr.selectedIndex].value,type="display_on";"woostify-header-footer-builder-no-display-on"===curr_id&&(type="no_display_on");var request=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_load_autocomplete&_ajax_nonce="+nonce+"&post_type="+postType+"&type="+type,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(request).then((function(res){200===res.status?res.json().then((function(r){var conditionGroup;r.success&&(curr.closest(".condition-group").getElementsByClassName("child-item")[0].innerHTML=r.data)})):console.log("Status Code: "+res.status)}))}})),document.addEventListener("click",(function(e){var curr=e.target||e.currentTarget,curr_class=curr.getAttribute("class");if(curr.classList.contains("woostify-select-all-post")||curr.classList.contains("woostify-arrow")||curr.classList.contains("woostify-select-all")){for(var parent,childItemsCount=(parent=curr.closest(".woostify-section-select-post")).children.length,render,i=0;i<childItemsCount;i++)if(parent.children[i].classList.contains("woostify-section-render--post")){render=parent.children[i];break}render.classList.contains("hidden")?(render.classList.remove("hidden"),parent.classList.remove("select-all"),parent.classList.add("render--post"),parent.getElementsByClassName("woostify--hf-post-name")[0].focus()):(render.classList.add("hidden"),parent.classList.remove("render--post"),parent.classList.add("select-all"))}if(curr.classList.contains("woostify-auto-complete-field")&&curr.querySelector(".woostify--hf-post-name").focus(),curr.classList.contains("post-item")&&!curr.classList.contains("disabled")){var inputItemWrapper,listPost=(inputItemWrapper=curr.closest(".input-item-wrapper")).querySelector(".woostify-post-ids").value,all=inputItemWrapper.querySelector(".woostify-select-all-post"),parentSelectPost=inputItemWrapper.querySelector(".woostify-section-select-post");all.classList.contains("hidden")||all.classList.add("hidden"),listPost=listPost&&"all"!==listPost?listPost.split(","):[],parentSelectPost.classList.contains("has-option")||parentSelectPost.classList.add("has-option");var id=curr.getAttribute("data-item"),title=curr.textContent;if(!listPost.includes(id)){listPost.push(id);var html='<span class="woostify-title">'+title+'</span><span class="btn-woostify-auto-complete-delete ion-close" data-item="'+id+'"></span>',newTagItem=document.createElement("span");newTagItem.classList.add("woostify-auto-complete-key"),newTagItem.innerHTML=html,inputItemWrapper.querySelector(".woostify-auto-complete-field").insertBefore(newTagItem,inputItemWrapper.querySelector(".woostify--hf-post-name"))}inputItemWrapper.querySelector(".woostify-post-ids").value=listPost,inputItemWrapper.querySelector(".woostify--hf-post-name").value="",curr.classList.add("disabled")}if(curr.classList.contains("btn-woostify-auto-complete-delete")){var id=curr.getAttribute("data-item"),inputItemWrapper,listPost=(inputItemWrapper=curr.closest(".input-item-wrapper")).querySelector(".woostify-post-ids").value,render=inputItemWrapper.querySelector(".woostify-section-render--post"),selectAllEl=inputItemWrapper.querySelector(".woostify-select-all-post"),parent=inputItemWrapper.querySelector(".woostify-section-select-post"),condition=inputItemWrapper.closest(".condition-group");""!==(listPost=listPost&&"all"!==listPost?(listPost=listPost.replace(","+id,"")).replace(id,""):[])&&null!=listPost||(listPost="all",render.classList.add("hidden"),parent.classList.remove("render--post"),parent.classList.add("select-all"),parent.classList.remove("has-option"),selectAllEl.classList.remove("hidden"),inputItemWrapper.querySelector(".woostify-data").innerHTML=""),inputItemWrapper.querySelector(".woostify-post-ids").value=listPost,curr.parentElement.remove()}if("woostify-header-template-sticky"===curr.getAttribute("name")){var sticky=document.querySelector('input[name="woostify-header-template-sticky"]').checked,conditionGroupSticky,stickyChildItem=curr.closest(".condition-group").querySelector(".child-item");sticky?stickyChildItem.classList.contains("hidden")&&stickyChildItem.classList.remove("hidden"):stickyChildItem.classList.contains("hidden")||stickyChildItem.classList.add("hidden")}if(document.querySelectorAll(".woostify--hf-post-name").length>0)for(var inputSearch=document.querySelectorAll(".woostify--hf-post-name"),inputSearchCount=inputSearch.length,c=0;c<inputSearchCount;c++)inputSearch[c].value="";if(document.querySelectorAll(".woostify-data").length>0)for(var dataContainer=document.querySelectorAll(".woostify-data"),dataContainerCount=dataContainer.length,j=0;j<dataContainerCount;j++)dataContainer[j].innerHTML=""})),document.addEventListener("keyup",(function(e){var btn=e.target;if(btn.classList.contains("woostify--hf-post-name")){var parentItem=btn.closest(".input-item-wrapper"),postType=parentItem.querySelector(".woostify-post-type").value,selectedPosts=parentItem.querySelector(".woostify-post-ids").value,keyword=btn.value,request=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_load_post&_ajax_nonce="+nonce+"&post_type="+postType+"&key="+keyword+"&selected="+selectedPosts,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(request).then((function(res){200===res.status?res.json().then((function(r){r.success&&(parentItem.getElementsByClassName("woostify-data")[0].innerHTML=r.data)})):console.log("Status Code: "+res.status)}))}}))}};document.addEventListener("DOMContentLoaded",(function(){"function"==typeof woostifyMoveWordpressUpdateVersionNotice&&woostifyMoveWordpressUpdateVersionNotice(),woostifyMultiSelect(),woostifyDependency(),woostifyMultiDependency(),woostifyUpdateValue(),woostifyTabSettings(),woostifySaveOptions(),woostifySaveOptionMessageClose(),woostifySaleNotificationAddNewMessage(),woostifySaleNotificationRemoveMessage(),woostifyHeaderFooterBuilderSelectTemplate(),woostifyChangeDisplayOption()}));