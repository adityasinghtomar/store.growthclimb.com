"use strict";var woostifySearchDelay=function(e){return void 0===e&&(e=0),function(t,o){clearTimeout(e),e=setTimeout(t,o)}}(),woostifySelectProductPreview=function(e){NProgress.start();var t={action:"woo_builder_select_product_preview",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,selected_id:e};t=new URLSearchParams(t).toString();var o=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:t,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(o).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(e){if(!e.success)return}).catch(function(e){console.log(e)}).finally(function(){"undefined"!=typeof elementor&&elementor.reloadPreview(),NProgress.done()})},woostifyWooBuilderPreview=function(){var e=document.getElementById("elementor-panel-footer-tools");if(e){window.wooBuilderOpen=null;var t=e.querySelector("#elementor-panel-footer-saver-preview");if(t&&woostify_woo_builder_editor.is_product_template){t.setAttribute("id","woostify-tool-preview-button");var o=e.querySelector("#elementor-panel-footer-saver-preview-label");if(o){var i="";i+='<div class="woostify-preview-settings-wrap">',i+='<div class="woostify-preview-settings-inner">',i+='<div class="woostify-preview-search">',i+='<div class="woostify-preview-search-result"></div>',i+='<input class="woostify-preview-search-field" placeholder="'+woostify_woo_builder_editor.search_placeholder+'">',i+="</div>",i+='<span class="woostify-preview-value" data-url>'+woostify_woo_builder_editor.select_preview+"</span>",i+='<span class="woostify-preview-button">'+woostify_woo_builder_editor.preview_text+"</span>",i+="</div>",i+="</div>",o.insertAdjacentHTML("afterend",i);var n=0,r=0;o.onclick=function(t){t.preventDefault(),0==r?(r=1,document.body.classList.add("hide-elementor-tooltip"),o.parentNode.classList.add("elementor-open")):(r=0,document.body.classList.remove("hide-elementor-tooltip"),o.parentNode.classList.remove("elementor-open"));var i=e.querySelector(".woostify-preview-settings-wrap"),a=i.querySelector(".woostify-preview-value"),s=i.querySelector(".woostify-preview-search"),l=i.querySelector(".woostify-preview-search-field"),c=i.querySelector(".woostify-preview-search-result"),u=i.querySelector(".woostify-preview-button");a&&(a.onclick=function(){s&&(0==n?(n=1,s.classList.add("active")):(n=0,s.classList.remove("active"))),l&&(l.focus(),l.oninput=function(){var e=l.value.trim();if(!e||!c){c.innerHTML="";return}woostifySearchDelay(function(){c&&(c.innerHTML='<span class="result-item">'+woostify_woo_builder_editor.searching_text+"</span>");var t={action:"woo_builder_preview_search_data",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,keyword:e};t=new URLSearchParams(t).toString();var o=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:t,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(o).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(e){e.success&&c&&(c.innerHTML=e.data.content)}).catch(function(e){console.log(e)}).finally(function(){var e=c?c.querySelectorAll(".result-item"):[];e.length&&e.forEach(function(e){e.onclick=function(){var t=e.getAttribute("data-url");if(t&&a){a.innerHTML=e.innerHTML,a.setAttribute("data-url",t);var o=e.getAttribute("data-id");o&&woostifySelectProductPreview(o),a.click()}}})})},500)})}),u&&(u.onclick=function(){var e=a?a.getAttribute("data-url"):"";e=e||woostify_woo_builder_editor.preview_url,window.wooBuilderOpen&&window.wooBuilderOpen.parent&&e===window.wooBuilderOpen.location.href?window.wooBuilderOpen.focus():window.wooBuilderOpen=window.open(e,"_blank")})}}}var a=e.querySelector("#elementor-panel-footer-sub-menu-item-save-template");if(a){var s=document.getElementById("elementor-editor-wrapper-v2");if(s){s.querySelector(".MuiGrid-root:last-child .MuiBox-root:last-child").insertAdjacentHTML("afterend",'<span class="MuiBox-root css-0" data-mui-internal-clone-element="true"><button id="" class="woostify-tool-display-conditions MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1dtexq-MuiButtonBase-root-MuiIconButton-root" tabindex="0" type="button" aria-label="'+woostify_woo_builder_editor.condition_text+'"><i class="elementor-icon eicon-sitemap" aria-hidden="true"></i></button></span>');var l=s.querySelector(".woostify-tool-display-conditions")}else{a.insertAdjacentHTML("beforebegin",'<div id="woostify-tool-display-conditions" class="woostify-tool-display-conditions elementor-panel-footer-sub-menu-item"><i class="elementor-icon eicon-flow" aria-hidden="true"></i><div class="elementor-title">'+woostify_woo_builder_editor.condition_text+"</div></div>");var l=e.querySelector(".woostify-tool-display-conditions")}var c=document.getElementById("elementor-preview"),u=document.getElementById("woostify-woobuilder-conditions-html");c&&u&&c.insertAdjacentHTML("afterend",u.innerHTML);var d=document.querySelector(".woostify-woobuilder-conditions");l&&d&&(l.onclick=function(e){e.preventDefault(),d.classList.add("active");var t=function(){d.classList.remove("active")};d.onclick=function(e){this===e.target&&t()};var o=d.querySelector(".woostify-woobuilder-conditions-close-btn");o&&(o.onclick=t),document.body.addEventListener("keyup",function(e){27===e.keyCode&&t()});var i=d.querySelector(".woostify-woobuilder-conditions-content-inner"),n=!!i&&i.querySelector(".woostify-woobuilder-condition-item-wrapper"),r=!!i&&i.querySelector(".woostify-condition-add-button"),a=function(){var e=document.querySelectorAll(".woostify-woobuilder-conditions .woostify-condition-item-remove");e.length&&e.forEach(function(e){e.onclick=function(){var t=e.parentNode;(t.nextElementSibling||t.previousElementSibling)&&t.remove()}})};if(a(),r){var s=r.getAttribute("data-type")||"";r.onclick=function(){var e=document.getElementById("woostify-woobuilder-conditions-"+s+"-html");e&&n&&n.insertAdjacentHTML("beforeend",e.innerHTML),a(),p()}}})}var f=document.getElementById("elementor-panel-saver-button-publish");if(f&&"publish"!=woostify_woo_builder_editor.post_status){f.insertAdjacentHTML("beforebegin",'<button id="woostify-panel-saver-button-publish" class="elementor-button elementor-button-success">'+f.innerHTML+"</button>");var v=document.getElementById("woostify-panel-saver-button-publish");if(!v)return;v.onclick=function(e){if(!this.classList.contains("elementor-disabled")){var t=document.getElementById("woostify-tool-display-conditions");t&&t.click()}}}var s=document.getElementById("elementor-editor-wrapper-v2");if(s&&"publish"!=woostify_woo_builder_editor.post_status){var w=s.querySelector(".MuiGrid-root:last-child .MuiButtonGroup-root > button");if(!w)return;w.insertAdjacentHTML("beforebegin",'<button id="woostify-panel-top-saver-button-publish" class="elementor-top-button css-1qcjli0-MuiButtonBase-root-MuiButton-root">'+f.innerHTML+"</button>");var y=document.getElementById("woostify-panel-top-saver-button-publish");if(!y)return;y.onclick=function(e){if(!this.classList.contains("elementor-disabled")){var t=document.querySelector(".woostify-tool-display-conditions");t&&t.click()}}}var p=function(){if(d){var e=d.querySelectorAll(".woostify-condition-item");e.length&&e.forEach(function(e){var t=e.querySelector(".woostify-condition-item-field"),o=e.querySelector(".woostify-condition-item-search-view");t&&(t.onchange=function(){["in-cat","in-tag"].includes(t.value)?e.classList.add("has-search-field"):(e.classList.remove("has-search-field"),o&&(o.setAttribute("data-id","all"),o.innerHTML=woostify_woo_builder_editor.all_text))});var i=e.querySelector(".woostify-condition-item-search");if(i){var n=i.querySelector(".woostify-condition-item-search-field"),r=0;i.onclick=function(e){var t=this,o=t.closest(".woostify-woobuilder-condition-item-wrapper"),a=o?o.querySelectorAll(".woostify-condition-item-search.active"):[];e.target!==n&&(a.length&&a.forEach(function(e){e!==t&&e.classList.remove("active")}),0==r?(t.classList.add("active"),r=1,n&&n.focus()):(r=0,t.classList.remove("active")),document.onclick=function(e){var o=e.target;o!==t&&o!==n&&(r=0,i.classList.remove("active"))})},n&&(n.oninput=function(){var e=i.querySelector(".woostify-condition-item-search-view"),o=n.value.trim(),r=i.querySelector(".woostify-condition-item-search-result");if(!o||!r){r.innerHTML="";return}woostifySearchDelay(function(){r&&(r.innerHTML='<span class="result-item">'+woostify_woo_builder_editor.searching_text+"</span>");var i={action:"woo_builder_conditions_search_data",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,field_value:t.value,keyword:o};i=new URLSearchParams(i).toString();var n=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:i,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(n).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(e){if(e.success){var t=e.data;r&&(r.innerHTML=t.content)}}).catch(function(e){console.log(e)}).finally(function(){var t=r?r.querySelectorAll(".result-item"):[];t.length&&t.forEach(function(t){t.onclick=function(){var o=t.getAttribute("data-id");o&&e&&(e.innerHTML=t.innerHTML,e.setAttribute("data-id",o))}})})},500)})}})}};p(),!function(){if(d){var e=d.querySelector(".save-options");e&&(e.onclick=function(){var e=d.querySelectorAll(".woostify-condition-item");if(e.length){NProgress.start(),d.click(),f&&f.classList.add("elementor-button-state");var t=document.getElementById("woostify-panel-saver-button-publish");t&&t.classList.add("disabled","elementor-button-state");var o=document.getElementById("woostify-panel-top-saver-button-publish");o&&o.classList.add("disabled","elementor-button-state");var i=[];e.forEach(function(e,t){var o=e.querySelector(".woostify-condition-item-type"),n=e.querySelector(".woostify-condition-item-field"),r=e.querySelector(".woostify-condition-item-search-view"),a=r?r.getAttribute("data-id"):"all";o&&n&&i.push({data_type:o.value,data_field:n.value,data_id:a})});var n={action:"save_woo_builder_conditions",ajax_nonce:woostify_woo_builder_editor.ajax_nonce,post_id:woostify_woo_builder_editor.post_id,conditions:JSON.stringify(i)};n=new URLSearchParams(n).toString();var r=new Request(woostify_woo_builder_editor.ajax_url,{method:"POST",body:n,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(r).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(e){if(!e.success)return}).catch(function(e){console.log(e)}).finally(function(){f&&(f.classList.remove("elementor-button-state"),f.click()),t&&t.classList.remove("elementor-button-state"),NProgress.done()})}})}}(),elementor.saver.on("after:save",function(e){window.wooBuilderOpen&&window.wooBuilderOpen.parent&&window.wooBuilderOpen.location.reload()})}};window.addEventListener("load",function(){woostifyWooBuilderPreview()});