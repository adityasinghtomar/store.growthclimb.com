"use strict";var woostifySearchDelay=function(){var timer=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(callback,ms){clearTimeout(timer),timer=setTimeout(callback,ms)}}();function woostifyAjaxProductSearch(){var selector=document.querySelectorAll(".search-field"),htmlClass,resultSuccess;htmlClass={link:"aps-link",image:"aps-thumbnail",itemTag:'<div class="aps-item">',contentTag:'<div class="asp-content">',priceTag:'<div class="aps-price">',titleTag:'<h4 class="aps-title">',skuTag:'<div class="aps-sku">',closeTag:"</div>",titleClose:"</h4>",categoryClass:'<div class="category-content">',headerTag:'<div class="search-heading">'},resultSuccess={dataHtml:function(data,resultsHtml){var html="",htmlTag=this,counterHtml=jQuery(resultsHtml).find(".search-dialog-count"),products=data.products,categories=data.categories,tags=data.tags,attributes=data.attributes,i,j,item;if(jQuery(".link-search-page").html(data.product_found+" "+woostify_ajax_product_search_data.products),categories&&categories.length>0){for(html+=this.categoryClass+this.headerTag+woostify_ajax_product_search_data.categories+this.closeTag,i=0,j=categories.length;i<j;i++)item=categories[i],html+=this.itemTag+'<a class="'+this.link+'" href="'+item.url+'"></a>'+this.contentTag+this.titleTag+item.name_hightline+this.titleClose+this.closeTag+this.closeTag;html+=this.closeTag}if(tags&&tags.length>0){for(html+=this.categoryClass+this.headerTag+woostify_ajax_product_search_data.tags+this.closeTag,i=0,j=tags.length;i<j;i++){var item=tags[i];html+=this.itemTag+'<a class="'+this.link+'" href="'+item.url+'"></a>'+this.contentTag+this.titleTag+item.name_hightline+this.titleClose+this.closeTag+this.closeTag}html+=this.closeTag}if(attributes&&attributes.length>0){for(html+=this.categoryClass+this.headerTag+woostify_ajax_product_search_data.attributes+this.closeTag,i=0,j=attributes.length;i<j;i++){var item=attributes[i];html+=this.itemTag+'<a class="'+this.link+'" href="'+item.url+'"></a>'+this.contentTag+this.titleTag+item.name_hightline+this.titleClose+this.closeTag+this.closeTag}html+=this.closeTag}if(data.products.length>0){if(counterHtml.length>0)counterHtml.html(data.product_found+" "+woostify_ajax_product_search_data.products);else{var title='<span class="search-dialog-count aps-highlight">'+data.product_found+" "+woostify_ajax_product_search_data.products+"</span>";jQuery(".dialog-search-title").append(title)}for(html+=this.categoryClass+this.headerTag+woostify_ajax_product_search_data.products+this.closeTag,i=0,j=products.length;i<j;i++){var item,sku="";(item=products[i]).sku_hightline&&(sku="SKU: "),html+=this.itemTag+'<a class="'+this.link+'" href="'+item.url+'"></a><img class="'+this.image+'" src="'+item.image+'" alt="'+item.name+'">'+this.contentTag+this.titleTag+item.name_hightline+this.titleClose+this.priceTag+item.html_price+this.closeTag+this.skuTag+sku+item.sku_hightline+this.closeTag+this.closeTag+this.closeTag}html+=this.closeTag,resultsHtml.querySelector(".ajax-search-results").innerHTML=html}resultsHtml.querySelector(".ajax-search-results").innerHTML=html,0==data.products.length&&(!tags||tags&&0==tags.length)&&(!categories||categories&&0==categories.length&&(!attributes||attributes&&0==attributes.length))&&(resultsHtml.querySelector(".ajax-search-results").innerHTML='<div class="aps-no-posts-found">'+woostify_ajax_product_search_data.no_product+"</div>",counterHtml.html(""))}},selector.length&&"undefined"!=typeof woostify_ajax_product_search_data&&selector.forEach((function(element){var form=element.closest("form"),isProductSearch=!!form&&form.classList.contains("woocommerce-product-search"),search=!!form&&form.querySelector(".search-field");if(form&&isProductSearch&&search){search.setAttribute("autocomplete","off");var parent=form.closest(".site-search")||form.closest(".dialog-search-content"),results=!!parent&&parent.querySelector(".ajax-search-results");if(results){var clearText=document.createElement("span");if(clearText.setAttribute("class","clear-search-results ti-close"),search.parentNode.insertBefore(clearText,search.nextSibling),woostify_ajax_product_search_data.lang){var inputLang=document.createElement("input");inputLang.setAttribute("type","hidden"),inputLang.setAttribute("name","lang"),inputLang.setAttribute("value",woostify_ajax_product_search_data.lang),search.parentNode.insertBefore(inputLang,search.nextSibling)}woostify_ajax_product_search_data.select&&(form.insertAdjacentHTML("afterbegin",woostify_ajax_product_search_data.select),form.classList.add("category-filter"));var category=form.querySelector(".ajax-product-search-category-filter"),language=form.querySelector("input[name=lang]"),fetchApi=function(){var categoryFilter=void 0!==arguments[0]&&arguments[0],catId=category?category.value.trim():"",lang=language?language.value.trim():"",keyword=search.value.trim();if(!keyword)return clearText.classList.remove("show"),results.classList.add("hide"),jQuery(parent).find(".total-result-wrapper").html(""),void jQuery(parent).find(".search-dialog-count").html("");clearText.classList.add("show"),results.classList.remove("hide"),clearText.onclick=function(){search.value="",clearText.classList.remove("show"),results.classList.add("hide"),jQuery(parent).find(".total-result-wrapper").html(""),jQuery(parent).find(".search-dialog-count").html("")};var prevValue=search.getAttribute("data-value");if(keyword!==prevValue||categoryFilter){var url;search.setAttribute("data-value",keyword),form.classList.add("loading"),url=jQuery(form).attr("action")+"?post_type=product&s="+keyword,catId&&(url+="&cat_id="+catId),lang&&(url+="&lang="+lang);var data={token:woostify_ajax_product_search_data.ajax_nonce,keyword:keyword,cat_id:catId,lang:lang},searchUrl=woostify_ajax_product_search_data.url;woostify_ajax_product_search_data.code_snippets&&(searchUrl=woostify_ajax_product_search_data.ajax_url,data.action="ajax_product_search",data.ajax_nonce=woostify_ajax_product_search_data.ajax_nonce),jQuery.ajax({type:"GET",url:searchUrl,data:data,beforeSend:function(response){jQuery(form).addClass("loading")},success:function(response){jQuery(form).removeClass("loading"),jQuery(parent).find(".total-result-wrapper").html(""),response.data.products.length>0&&jQuery(parent).find(".total-result-wrapper").html('<a href="'+url+'" class="link-search-page aps-highlight">'+response.data.size+woostify_ajax_product_search_data.products+"</a>"),resultSuccess.dataHtml.call(htmlClass,response.data,parent),jQuery(document).on("keyup keypress",(function(e){var keyCode;if(13===(e.keyCode||e.which)){if(e.preventDefault(),0==response.data.products.length)return!1;window.location.href=url}}))}})}};search.addEventListener("input",(function(){woostifySearchDelay((function(){fetchApi()}),500)})),category&&category.addEventListener("change",(function(){fetchApi(!0),search.focus()}))}}}))}document.addEventListener("DOMContentLoaded",(function(){woostifyAjaxProductSearch()}));