"use strict";var frequently_bought_together_admin=function(){var t=document.querySelector("#frequently_bought_together_options .search-input"),e=document.querySelector("#frequently_bought_together_options .search-result");e.style.display="none",t.addEventListener("click",function(){e.style.display="block"}),document.addEventListener("click",function(t){var r=document.querySelector("#frequently_bought_together_options .search-product");r&&(r.contains(t.target)||(e.style.display="none"))});var r=0;t.addEventListener("keyup",function(){clearTimeout(r),r=setTimeout(function(){var r=t.value;r.toLowerCase().replace(/\s/g,""),t.classList.add("loading");var n=[];document.querySelectorAll("#frequently_bought_together_options .product-list .product__item").forEach(function(t){t.hasAttribute("data-product-id")&&n.push(t.getAttribute("data-product-id"))});var o={action:"woostify_fbt_search_product",keyword:r,_nonce:woostify_fbt._nonce};e.innerHTML="",r.length>1&&(o=new URLSearchParams(o).toString(),fetch(woostify_fbt.ajaxurl,{method:"POST",body:o,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(t){if(200!==t.status)throw console.log("Status Code: "+t.status),t;return t.json()}).then(function(r){t.classList.remove("loading");var o=r;if(o.product_list&&o.product_list.length>0){var i=o.product_list,a="";i.length>0&&(e.style.display="block",i.forEach(function(t){-1==n.indexOf(t.id.toString())&&(a+='<li class="search-result-item '+t.stock_status+'" data-id="'+t.id+'" onclick="frequently_add_product_to_list(this)"><figure>'+t.image+'</figure><div class="product__info"><h2>'+t.name+"</h2>"+t.price+"</div></li>")})),e.innerHTML="<ul>"+a+"</ul>"}else e.innerHTML="<p>"+woostify_fbt.no_result+"</p>"}).catch(function(t){e.innerHTML="<p>"+woostify_fbt.no_result+"</p>"}))},400)})};function frequently_add_product_to_list(t){var e=document.querySelector("#frequently_bought_together_options .search-result"),r=t.getAttribute("data-id"),n=document.querySelector("#frequently_bought_together_options .product-list table"),o=1;n.querySelectorAll("tr").forEach(function(t){var e=t.getAttribute("data-item");e>=o&&(o=parseInt(e)+1)}),t.classList.add("loading");var i={action:"woostify_fbt_add_product",product_id:r,item_id:o,_nonce:woostify_fbt._nonce};i=new URLSearchParams(i).toString(),fetch(woostify_fbt.ajaxurl,{method:"POST",body:i,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(t){if(200!==t.status)throw console.log("Status Code: "+t.status),t;return t.json()}).then(function(r){if(t.remove(),r.data){var i=r.data;n.querySelector("tbody").innerHTML+=i;let a="<table><tbody>"+i+"</tbody></table>";var i=new DOMParser().parseFromString(a,"text/html"),c=i.querySelector(".product__item--image").innerHTML,d=i.querySelector(".product__item--title").textContent,u=i.querySelector("input").getAttribute("data-price");document.querySelector(".packed__product").innerHTML+='<td data-item="'+o+'">\n<div class="packed__product__image">'+c+'\n<span class="plus">+</span>\n</div>\n<div class="packed__product__name">'+d+"</div>\n</td>",document.querySelector(".packed__percent").innerHTML+=' <td data-item="'+o+'">\n<input data-price="'+u+'" name="woostify_fbt['+o+'][percent]" type="number" value="5">\n</td>'}e.style.display="none"}).catch(function(t){e.style.display="none",console.log(t)})}function frequently_remove_product_list(t){var e=t.closest("tr").getAttribute("data-item"),r=document.querySelectorAll('[data-item="'+e+'"]');for(var n in r)r.hasOwnProperty(n)&&r[n].remove()}function frequently_variation_change_in_list(t){var e=t.closest("tr"),r=t.closest(".product_variations"),n=JSON.parse(r.getAttribute("data-variations")),o=r.querySelectorAll("select"),i={};o.forEach(function(t){var e=t.getAttribute("data-attribute_name"),r=t.value;i[e]=r});var a=n.filter(function(t){var e=t.attributes,r=!0;for(var n in i)i[n]!==e[n]&&(r=!1);return r});0!=a.length&&(e.querySelector(".product__item--price").innerHTML=a[0].price_html)}var panelEditToggle=function(){var t=document.querySelector(".woostify_fbt-title-desciption-edit"),e=document.getElementById("woostify_fbt_enable");e.checked?t.classList.remove("hidden"):t.classList.add("hidden"),e.addEventListener("change",function(e){e.currentTarget.checked?t.classList.remove("hidden"):t.classList.add("hidden")})};document.addEventListener("DOMContentLoaded",function(){frequently_bought_together_admin(),panelEditToggle()});